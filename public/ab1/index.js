let spread,cs=2e3,cs2=.5*cs,palettes=["https://coolors.co/cc5803-e2711d-ff9505-ffb627-ffc971"],permutePalettes=!0,hueBase=360*Math.random(),hueShift=100,hueStep=6,hue=hueBase;function makeSketch(){spread=random([1,1.5,2,2.5]);let e=random()<.5?random(1,20):random(85,95);pg.background(e);let a=new Box(.1*cs,.1*cs,.8*cs,.8*cs);fillBox(a);let[o,t]=random([[2,2],[2,4],[3,4],[2,3],[3,2]]);random()<.1&&([o,t]=[Math.floor(random(2,10)),Math.floor(random(2,10))]);let r=a.gridify(o,o);r.forEach(e=>e.forEach(e=>fillBox(e))),(r=a.gridify(t,t)).forEach(e=>e.forEach(e=>e.rotate(Math.floor(random(4))))),pg.drawingContext.globalAlpha=1,pg.blendMode(BLEND);let l=e>50?100:0;setMask(new Box(0,0,cs,cs),.8,pg.color(l),RECT_SHAPE)}function fillBox(e){let[a,o]=getColors();pg.noStroke(),pg.drawingContext.globalAlpha=1,fillGradient(getCircleGradient(e.c.x,e.c.y,.5*e.w*2,[a,o])),e.circle(1),pg.noStroke(),pg.drawingContext.globalAlpha=1,pg.drawingContext.globalCompositeOperation="soft-light",makeFleck(e,.5,0,.4,0,1,50),hue=hueBase}function makeFleck(e,a,o,t,r,l,c){for(let s=0;s<c;s++){let[c,s]=getColors(),n=(random()*l+r)*TWO_PI,i=(random(t)+o)*a*e.w,d=createVector(e.c.x+cos(n)*i,e.c.y+sin(n)*i),g=a*spread*e.w*random();fillGradient(getCircleGradient(d.x,d.y,.5*g,[c,s])),pg.circle(d.x,d.y,g)}}function getColors(){return c=pg.color(hue,90,90),hue=(hue+hueStep)%360,pg.colorMode(RGB),c2=pg.color(c.levels),c2.setAlpha(0),pg.colorMode(HSB),[c,c2]}function getCircleGradient(e,a,o,t){gradient=pg.drawingContext.createRadialGradient(e,a,0,e,a,o),s=1/(t.length-1);for(let e=0;e<t.length;e++)gradient.addColorStop(e*s,t[e]);return gradient}const RECT_SHAPE=0,CIRCLE_SHAPE=1;function setMask(e,a,o,t){switch(mask=createGraphics(e.w,e.h),mask.fill("rgba(0, 0, 0, 1)"),t){case RECT_SHAPE:mask.rectMode(CENTER),mask.rect(.5*e.w,.5*e.w,a*e.w,a*e.h);break;case CIRCLE_SHAPE:mask.circle(.5*e.w,.5*e.w,a*e.w)}mask.filter(INVERT),mask.loadPixels();let r=red(o),l=green(o),c=blue(o);for(let e=0;e<mask.pixels.length;e+=4)mask.pixels[e]=r,mask.pixels[e+1]=l,mask.pixels[e+2]=c,mask.pixels[e+3]=255-mask.pixels[e+3];mask.updatePixels(),pg.image(mask,e.x,e.y,e.w,e.h)}